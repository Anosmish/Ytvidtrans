<!DOCTYPE html>
<html>
<head>
    <title>Multi-language TTS</title>
    <style>
        body { font-family: Arial; margin: 30px; }
        textarea { width: 100%; }
        input[type=range] { width: 100%; }
        button { padding: 10px 20px; margin-top: 10px; }
        #spinner-overlay {
            display: none;
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(255,255,255,0.8);
            z-index: 9999;
            text-align: center;
            padding-top: 200px;
            font-size: 20px;
            font-weight: bold;
            color: #3498db;
        }
        #spinner {
            border: 6px solid #f3f3f3;
            border-top: 6px solid #3498db;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-right: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg);}
            100% { transform: rotate(360deg);}
        }
    </style>
</head>
<body>
    <h1>Text-to-Speech Converter</h1>

    <button onclick="wakeService()">Start Service</button>
    <p id="wake-msg"></p>

    <textarea id="text" rows="5" placeholder="Enter text here..."></textarea><br><br>

    <label>Language:</label>
    <select id="language">
        <option value="English US">English US</option>
        <option value="English UK">English UK</option>
        <option value="French">French</option>
        <option value="German">German</option>
        <option value="Hindi">Hindi</option>
    </select><br><br>

    <label>Gender:</label>
    <select id="gender">
        <option value="Female">Female</option>
        <option value="Male">Male</option>
    </select><br><br>

    <label>Translate to (optional):</label>
    <select id="translate">
        <option value="None">None</option>
        <option value="en">English</option>
        <option value="fr">French</option>
        <option value="de">German</option>
        <option value="hi">Hindi</option>
        <option value="es">Spanish</option>
    </select><br><br>

    <label>Rate (-100 to 100):</label><br>
    <input type="range" id="rate" min="-100" max="100" value="0"><br><br>

    <label>Pitch (-100 to 100):</label><br>
    <input type="range" id="pitch" min="-100" max="100" value="0"><br><br>

    <button onclick="generateAudio()">Generate Audio</button>

    <div id="spinner-overlay"><div id="spinner"></div>Generating...</div>

    <h2>Preview:</h2>
    <audio id="audio" controls></audio><br>
    <a id="download-link" href="" download>Download Audio</a>

<script>
const backend_url = "https://YOUR-RENDER-APP.onrender.com";

function wakeService() {
    fetch(`${backend_url}/wake`)
        .then(res => res.json())
        .then(data => {
            document.getElementById("wake-msg").innerText = data.status;
        });
}

function generateAudio() {
    const text = document.getElementById("text").value;
    const language = document.getElementById("language").value;
    const gender = document.getElementById("gender").value;
    const rate = document.getElementById("rate").value;
    const pitch = document.getElementById("pitch").value;
    const translate_to = document.getElementById("translate").value;

    if(!text) { alert("Please enter some text"); return; }

    // Show overlay spinner
    const overlay = document.getElementById("spinner-overlay");
    overlay.style.display = "block";

    // Disable form elements
    document.querySelectorAll("input, textarea, select, button").forEach(el => el.disabled = true);

    fetch(`${backend_url}/generate`, {
        method: "POST",
        headers: {"Content-Type": "application/json"},
        body: JSON.stringify({text, language, gender, rate, pitch, translate_to})
    })
    .then(res => res.json())
    .then(data => {
        overlay.style.display = "none";
        document.querySelectorAll("input, textarea, select, button").forEach(el => el.disabled = false);

        if(data.audio_url){
            const audioEl = document.getElementById("audio");
            const linkEl = document.getElementById("download-link");
            audioEl.src = backend_url + data.audio_url;
            linkEl.href = backend_url + data.audio_url;
        } else {
            alert("Error generating audio");
        }
    })
    .catch(err => {
        overlay.style.display = "none";
        document.querySelectorAll("input, textarea, select, button").forEach(el => el.disabled = false);
        alert("Error: " + err);
    });
}
</script>
</body>
</html>
